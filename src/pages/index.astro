---
import Layout from '../layouts/Layout.astro';
import ProjectCard from '../components/ProjectCard.astro';
import { getCollection } from 'astro:content';

const allProjects = await getCollection('projects');

// Featured projects: explicit flag, fallback to 3 most recent
const featuredProjects = allProjects
  .filter((p) => p.data.featured)
  .sort((a, b) => b.data.date.getTime() - a.data.date.getTime());

const displayProjects =
  featuredProjects.length > 0
    ? featuredProjects
    : allProjects
        .sort((a, b) => b.data.date.getTime() - a.data.date.getTime())
        .slice(0, 3);
---

<Layout title="Home" description="Portfolio of Elias — Mechanical Engineer specializing in precision design, robotics, and manufacturing.">
  <!-- Hero Section -->
  <section class="py-2 sm:py-4 reveal">
    <div class="md:grid md:grid-cols-2 gap-8 items-center">
      <!-- Left: Text Content -->
      <div class="space-y-6">
        <p class="font-mono text-sm text-technical tracking-wider uppercase">
          Mechanical Engineer & Designer
        </p>
        <h1 class="text-5xl sm:text-7xl font-bold tracking-tighter leading-[0.9] text-zinc-950">
          Elias<br />Vanier.
        </h1>
        <p class="text-lg text-zinc-500 max-w-lg leading-relaxed">
          23 yr old - Rochester Institute of Technology Student · Robotics · Manufacturing
        </p>
        <div class="flex gap-4 pt-2">
          <a
            href="/projects"
            class="px-6 py-3 text-sm font-medium text-white bg-zinc-950 hover:bg-technical transition-colors rounded-sm"
          >
            View Projects
          </a>
          <a
            href="/about"
            class="px-6 py-3 text-sm font-medium text-zinc-950 border border-zinc-300 hover:border-zinc-950 transition-colors rounded-sm"
          >
            About Me
          </a>
        </div>
      </div>
      <!-- Right: Headshot -->
      <div class="mt-10 md:mt-0 flex justify-center">
        <img
          src="/images/headshot.jpg"
          alt="Elias — Mechanical Engineer"
          class="w-full max-w-sm rounded shadow-lg border border-zinc-200"
        />
      </div>
    </div>
  </section>

  <!-- Featured Projects -->
  <section class="pb-20 space-y-8 reveal">
    <div class="flex items-center justify-between">
      <h2 class="text-2xl font-bold tracking-tight text-zinc-950">Featured Work</h2>
      <a
        href="/projects"
        class="text-sm font-medium text-zinc-400 hover:text-technical transition-colors flex items-center gap-1"
      >
        All Projects
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg>
      </a>
    </div>
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
      {displayProjects.map((project) => (
        <div class="reveal">
          <ProjectCard project={project} />
        </div>
      ))}
    </div>
  </section>
</Layout>
